# Supabase Type Safety

## Getting Started

### Installing Supabase
```bash
npm i supabase@">=1.8.1" --save-dev
```

### Login
```bash
npx supabase login
```

### Init
```bash
npx supabase init
```

### Generate Types

We need to get the project Id, in this case `kgrejhxortrsargiudrx`

```bash
npx supabase gen types typescript --project-id kgrejhxortrsargiudrx --schema public > database.types.ts
```


## Table Types

Example of how to correctly extrac the table types from the database.types.ts file

```ts
import { Database, Tables, Enums } from "./database.types.ts";

// Before ğŸ˜•
let movie: Database['public']['Tables']['movies']['Row'] = // ...

// After ğŸ˜
let movie: Tables<'movies'>
```

## Response Types

Example of the correct typing for `supabase` calls 

```ts
import { QueryResult, QueryData, QueryError } from '@supabase/supabase-js'

const countriesWithCitiesQuery = supabase.from('countries').select(`
  id,
  name,
  cities (
    id,
    name
  )
`)
type CountriesWithCities = QueryData<typeof countriesWithCitiesQuery>

const { data, error } = await countriesWithCitiesQuery
if (error) throw error
const countriesWithCities: CountriesWithCities = data
```

In our case remember we are using the `@nuxt/supabase` module so we can use the `serverSupabaseServiceRole` function to get the correct typings

### References

[Generating Supabes Types](https://supabase.com/docs/guides/api/rest/generating-types)